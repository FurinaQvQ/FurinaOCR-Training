import json

main_stat_data = []

exp_per_level = [[170, 240, 310, 410, 500, 620, 0],
    [280, 400, 520, 680, 840, 1080, 1320, 1620, 2060, 0],
    [420, 600, 780, 1020, 1200, 1480, 1980, 2430, 3090, 3840, 4760, 5900, 0],
    [560, 800, 1040, 1360, 1680, 2060, 2640, 3240, 4120, 5120, 6350, 8030, 10320, 12960, 15720, 0]
]

main_stat_num = {
    5: {
        "FIGHT_PROP_HP": [112.0000, 152.0000, 191.0000, 231.0000, 270.0000, 310.0000, 349.0000, 389.0000, 429.0000, 468.0000, 508.0000, 547.0000, 587.0000, 626.0000, 666.0000, 705.0000],
        "FIGHT_PROP_HP_PERCENTAGE": [0.0690, 0.0930, 0.1170, 0.1410, 0.1650, 0.1900, 0.2140, 0.2380, 0.2620, 0.2860, 0.3110, 0.3350, 0.3590, 0.3830, 0.4070, 0.4320],
        "FIGHT_PROP_ATK": [56.0000, 76.0000, 95.9000, 115.7000, 135.0000, 155.0000, 174.9000, 194.7000, 214.5000, 234.0000, 254.0000, 273.7000, 293.5000, 313.0000, 333.0000, 352.7000],
        "FIGHT_PROP_ATK_PERCENTAGE": [0.0690, 0.0930, 0.1170, 0.1410, 0.1650, 0.1900, 0.2140, 0.2380, 0.2620, 0.2860, 0.3110, 0.3350, 0.3590, 0.3830, 0.4070, 0.4320],
        "FIGHT_PROP_DEF_PERCENTAGE": [0.0860, 0.1160, 0.1460, 0.1770, 0.2070, 0.2370, 0.2670, 0.2980, 0.3280, 0.3580, 0.3880, 0.4190, 0.4490, 0.4790, 0.5090, 0.5400],
        "FIGHT_PROP_SPD": [4.0000, 5.0000, 6.0000, 8.0000, 9.0000, 11.0000, 12.0000, 13.0000, 15.0000, 16.0000, 18.0000, 19.0000, 20.0000, 22.0000, 23.0000, 25.0000],
        "FIGHT_PROP_CRIT_RATE": [0.0520, 0.0700, 0.0880, 0.1060, 0.1240, 0.1420, 0.1600, 0.1780, 0.1960, 0.2150, 0.2330, 0.2510, 0.2690, 0.2870, 0.3050, 0.3240],
        "FIGHT_PROP_CRIT_DMG": [0.1040, 0.1400, 0.1760, 0.2120, 0.2480, 0.2850, 0.3210, 0.3570, 0.3930, 0.4300, 0.4660, 0.5020, 0.5390, 0.5750, 0.6110, 0.6480],
        "FIGHT_PROP_BREAK_EFFECT": [0.1030, 0.1390, 0.1760, 0.2120, 0.2480, 0.2850, 0.3210, 0.3570, 0.3930, 0.4300, 0.4660, 0.5020, 0.5390, 0.5750, 0.6110, 0.6480],
        "FIGHT_PROP_OUTGOING_HEALING_BOOST": [0.0550, 0.0740, 0.0940, 0.1130, 0.1320, 0.1520, 0.1710, 0.1900, 0.2100, 0.2290, 0.2480, 0.2680, 0.2870, 0.3060, 0.3260, 0.3450],
        "FIGHT_PROP_EFFECT_HIT_RATE": [0.0690, 0.0930, 0.1170, 0.1410, 0.1650, 0.1900, 0.2140, 0.2380, 0.2620, 0.2860, 0.3110, 0.3350, 0.3590, 0.3830, 0.4070, 0.4320],
        "FIGHT_PROP_ENERGY_REGENERATION_RATE": [0.0310, 0.0410, 0.0520, 0.0630, 0.0740, 0.0850, 0.0960, 0.1070, 0.1180, 0.1290, 0.1390, 0.1500, 0.1610, 0.1720, 0.1830, 0.1940],
        "FIGHT_PROP_DMG_BOOST": [0.0620, 0.0830, 0.1050, 0.1270, 0.1490, 0.1710, 0.1920, 0.2140, 0.2360, 0.2580, 0.2790, 0.3010, 0.3230, 0.3450, 0.3670, 0.3880]
    },
    4: {
        "FIGHT_PROP_HP": [90.0000, 121.0000, 153.0000, 185.0000, 216.0000, 248.0000, 279.0000, 311.0000, 343.0000, 374.0000, 406.0000, 438.0000, 469.0000],
        "FIGHT_PROP_HP_PERCENTAGE": [0.0550, 0.0740, 0.0940, 0.1130, 0.1320, 0.1520, 0.1710, 0.1900, 0.2100, 0.2290, 0.2480, 0.2680, 0.2870],
        "FIGHT_PROP_ATK": [45.0000, 60.0000, 76.0000, 92.0000, 108.0000, 124.0000, 139.0000, 155.0000, 171.0000, 187.0000, 203.0000, 219.0000, 234.0000],
        "FIGHT_PROP_ATK_PERCENTAGE": [0.0550, 0.0740, 0.0940, 0.1130, 0.1320, 0.1520, 0.1710, 0.1900, 0.2100, 0.2290, 0.2480, 0.2680, 0.2870],
        "FIGHT_PROP_DEF_PERCENTAGE": [0.0690, 0.0930, 0.1170, 0.1410, 0.1650, 0.1900, 0.2140, 0.2380, 0.2620, 0.2860, 0.3110, 0.3350, 0.3590],
        "FIGHT_PROP_SPD": [3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000, 12.0000, 13.0000, 14.0000, 15.0000, 16.0000],
        "FIGHT_PROP_CRIT_RATE": [0.0410, 0.0550, 0.0700, 0.0850, 0.0990, 0.1140, 0.1280, 0.1430, 0.1570, 0.1720, 0.1860, 0.2010, 0.2150],
        "FIGHT_PROP_CRIT_DMG": [0.0820, 0.1110, 0.1410, 0.1700, 0.1990, 0.2280, 0.2570, 0.2860, 0.3150, 0.3440, 0.3730, 0.4020, 0.4310],
        "FIGHT_PROP_BREAK_EFFECT": [0.0820, 0.1110, 0.1410, 0.1700, 0.1990, 0.2280, 0.2570, 0.2860, 0.3150, 0.3440, 0.3730, 0.4020, 0.4310],
        "FIGHT_PROP_OUTGOING_HEALING_BOOST": [0.0440, 0.0590, 0.0750, 0.0900, 0.1060, 0.1210, 0.1370, 0.1520, 0.1680, 0.1830, 0.1990, 0.2140, 0.2300],
        "FIGHT_PROP_EFFECT_HIT_RATE": [0.0550, 0.0740, 0.0940, 0.1130, 0.1320, 0.1520, 0.1710, 0.1900, 0.2100, 0.2290, 0.2480, 0.2680, 0.2870],
        "FIGHT_PROP_ENERGY_REGENERATION_RATE": [0.0240, 0.0330, 0.0420, 0.0510, 0.0590, 0.0680, 0.0770, 0.0850, 0.0940, 0.1030, 0.1110, 0.1200, 0.1290],
        "FIGHT_PROP_DMG_BOOST": [0.0490, 0.0670, 0.0840, 0.1020, 0.1190, 0.1360, 0.1540, 0.1710, 0.1890, 0.2060, 0.2230, 0.2410, 0.2580]
    },
    3: {
        "FIGHT_PROP_HP": [67.0000, 91.0000, 115.0000, 138.0000, 162.0000, 186.0000, 209.0000, 233.0000, 257.0000, 281.0000],
        "FIGHT_PROP_HP_PERCENTAGE": [0.0410, 0.0550, 0.0700, 0.0850, 0.0990, 0.1140, 0.1280, 0.1430, 0.1570, 0.1720],
        "FIGHT_PROP_ATK": [33.0000, 45.0000, 57.0000, 69.0000, 81.0000, 93.0000, 104.0000, 116.0000, 128.0000, 140.0000],
        "FIGHT_PROP_ATK_PERCENTAGE": [0.0410, 0.0550, 0.0700, 0.0850, 0.0990, 0.1140, 0.1280, 0.1430, 0.1570, 0.1720],
        "FIGHT_PROP_DEF_PERCENTAGE": [0.0510, 0.0690, 0.0880, 0.1060, 0.1240, 0.1420, 0.1600, 0.1780, 0.1960, 0.2150],
        "FIGHT_PROP_SPD": [2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000, 11.0000],
        "FIGHT_PROP_CRIT_RATE": [0.0310, 0.0410, 0.0520, 0.0630, 0.0740, 0.0850, 0.0960, 0.1070, 0.1180, 0.1290],
        "FIGHT_PROP_CRIT_DMG": [0.0620, 0.0830, 0.1050, 0.1270, 0.1490, 0.1710, 0.1920, 0.2140, 0.2360, 0.2580],
        "FIGHT_PROP_BREAK_EFFECT": [0.0620, 0.0830, 0.1050, 0.1270, 0.1490, 0.1710, 0.1920, 0.2140, 0.2360, 0.2580],
        "FIGHT_PROP_OUTGOING_HEALING_BOOST": [0.0330, 0.0440, 0.0560, 0.0680, 0.0790, 0.0910, 0.1020, 0.1140, 0.1260, 0.1370],
        "FIGHT_PROP_EFFECT_HIT_RATE": [0.0410, 0.0550, 0.0700, 0.0850, 0.0990, 0.1140, 0.1280, 0.1430, 0.1570, 0.1720],
        "FIGHT_PROP_ENERGY_REGENERATION_RATE": [0.0180, 0.0250, 0.0310, 0.0380, 0.0440, 0.0510, 0.0570, 0.0640, 0.0700, 0.0770],
        "FIGHT_PROP_DMG_BOOST": [0.0370, 0.0500, 0.0630, 0.0760, 0.0890, 0.1020, 0.1150, 0.1280, 0.1410, 0.1540]
    }
}

main_stat_names = ["FIGHT_PROP_HP", "FIGHT_PROP_HP_PERCENTAGE", "FIGHT_PROP_ATK", "FIGHT_PROP_ATK_PERCENTAGE", "FIGHT_PROP_DEF_PERCENTAGE", "FIGHT_PROP_SPD", "FIGHT_PROP_CRIT_RATE", "FIGHT_PROP_CRIT_DMG", "FIGHT_PROP_BREAK_EFFECT", "FIGHT_PROP_OUTGOING_HEALING_BOOST", "FIGHT_PROP_ENERGY_REGENERATION_RATE", "FIGHT_PROP_EFFECT_HIT_RATE", "FIGHT_PROP_PHYSICAL_DMG_BOOST", "FIGHT_PROP_FIRE_DMG_BOOST", "FIGHT_PROP_ICE_DMG_BOOST", "FIGHT_PROP_WIND_DMG_BOOST", "FIGHT_PROP_LIGHTNING_DMG_BOOST", "FIGHT_PROP_QUANTUM_DMG_BOOST", "FIGHT_PROP_IMAGINARY_DMG_BOOST"]

for rank in range(1, 6):
    for level in range(1, rank * 3 + 2):
        item = {}
        item["Rank"] = rank
        item["Level"] = level
        if rank == 1:
            item["Exp"] = 0
        else:
            item["Exp"] = exp_per_level[rank - 2][level - 1]
        item["AddProps"] = []
        for name in main_stat_names:
            prop = {}
            prop["PropType"] = name
            # 如果 name 中包含 DMG_BOOST 则需要额外处理
            if "DMG_BOOST" in name:
                if rank < 3:
                    prop["Value"] = 0
                else:
                    prop["Value"] = main_stat_num[rank]["FIGHT_PROP_DMG_BOOST"][level - 1]
            else:
                if rank < 3:
                    prop["Value"] = 0
                else:
                    prop["Value"] = main_stat_num[rank][name][level - 1]
            item["AddProps"].append(prop)
        main_stat_data.append(item)

# print(main_stat_data)
with open("../assets/RelicLevelExcelConfigData.json", "w") as f:
    f.write(json.dumps(main_stat_data, indent=4, ensure_ascii=False))
